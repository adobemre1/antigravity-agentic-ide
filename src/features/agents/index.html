<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Antigravity - Swarm Intelligence</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="dashboard.css">
  <link rel="stylesheet" href="../settings/modal.css">
  <link rel="stylesheet" href="../palette/palette.css">
  <link rel="stylesheet" href="../../features/nav/nav.css"> <!-- Re-use Nav Styles -->
</head>
<body>

  <!-- Re-use Floating Nav (Simulated) -->
  <nav class="floating-nav" style="position: absolute; top: 0; width: 100%;">
    <div class="nav-content">
      <div class="nav-brand">
        <div class="brand-logo">AG</div>
        <span class="brand-name">Antigravity</span>
      </div>
      <ul class="nav-links">
        <li><a href="../../features/editor/index.html" class="nav-link">Editor</a></li>
        <li><a href="#" class="nav-link active">Agents</a></li>
        <li><a href="#artifacts" class="nav-link">Artifacts</a></li>
        <li><a href="#docs" class="nav-link">Docs</a></li>
      </ul>
      <div class="nav-actions">
           <a href="#" onclick="openSettings()" style="color: #66fcf1; text-decoration: none; font-size: 0.9rem; margin-right: 20px;">⚙️ Config</a>
           <a href="../../../index.html" style="color: white; text-decoration: none; font-size: 0.9rem;">Exit Dashboard</a>
      </div>
    </div>
  </nav>

  <div class="dashboard-container">
    
    <!-- 1. Stats Sidebar -->
    <aside class="stats-sidebar">
      <div class="hud-panel">
        <h2>System Load</h2>
        <div class="metric-box">
           <div class="gauge-container" id="cpu-gauge">45%</div>
           <div class="stat-label">NEURAL ENGINE</div>
        </div>
        <div class="metric-box" style="margin-top: 20px;">
           <div class="gauge-container" id="memory-gauge" style="border-top-color: var(--neon-purple);">1.2TB</div>
           <div class="stat-label">CONTEXT WINDOW</div>
        </div>
      </div>
      
      <div class="hud-panel" style="flex: 1;">
         <h2>Network Status</h2>
         <div style="font-size: 0.8rem; line-height: 1.6; color: #aaa;">
            <div>> Uplink: Stable</div>
            <div>> Handshake: Verified</div>
            <div>> Latency: 12ms</div>
            <div style="margin-top: 10px; color: var(--neon-green);">● SECURITY: ACTIVE</div>
         </div>
      </div>
    </aside>

    <!-- 2. Main Agent Grid -->
    <main class="agent-grid-area">
      <div class="hud-panel" style="height: 100%; display: flex; flex-direction: column;">
        <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
            <h2>Active Agent Swarm</h2>
            <div style="color: var(--neon-cyan);">4/4 ONLINE</div>
        </div>
        <div class="agents-grid" id="agents-grid">
           <!-- Injected by JS -->
        </div>
      </div>
    </main>

    <!-- 3. Live Logs -->
    <aside class="log-panel">
      <div class="hud-panel" style="height: 100%; display: flex; flex-direction: column;">
        <h2>Thought Stream</h2>
        <div class="terminal-window" id="terminal-logs">
           <!-- Injected by JS -->
        </div>
      </div>
    </aside>

  </div>

  <script src="../store/store.js"></script>
  <script src="swarm.js"></script>
  <script src="../palette/palette.js"></script>
</body>
</html>

<!-- Settings Modal Injection -->
<div class="modal-overlay" id="settings-modal">
  <div class="modal-window">
    <div class="modal-header">
      <div class="modal-title">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>
        Agent Configuration
      </div>
      <div class="modal-close" onclick="closeSettings()">✕</div>
    </div>
    <div class="modal-body">
      
      <!-- Model Selection -->
      <div class="form-group">
        <label class="form-label">Primary Reasoning Model</label>
        <div class="model-selector">
          <div class="model-option active" id="opt-gemini" onclick="selectModel('gemini')">
            Gemini 3 Pro
            <div style="font-size: 0.7em; opacity: 0.7;">High Reasoning</div>
          </div>
          <div class="model-option" id="opt-gpt" onclick="selectModel('gpt')">
            GPT-OSS 120B
            <div style="font-size: 0.7em; opacity: 0.7;">High Speed</div>
          </div>
        </div>
      </div>

      <!-- Thinking Level -->
      <div class="form-group">
        <label class="form-label">Thinking Level (Chain of Thought)</label>
        <div class="slider-container">
          <span style="font-size: 0.8rem; opacity: 0.7;">Fast</span>
          <input type="range" min="1" max="10" value="8" id="thinking-slider" oninput="updateThinkingVal(this.value)">
          <span class="setting-value" id="thinking-val">High</span>
        </div>
      </div>

      <!-- Context Window -->
      <div class="form-group">
        <label class="form-label">Context Window Size</label>
        <div class="slider-container">
          <input type="range" min="1" max="3" value="3" id="context-slider" oninput="updateContextVal(this.value)">
          <span class="setting-value" id="context-val">1M</span>
        </div>
      </div>

    </div>
    <div class="modal-footer">
      <button class="btn-save" onclick="saveSettings()">Save Configuration</button>
    </div>
  </div>
</div>

<script>
  // Simple Settings Logic
  function openSettings() {
    document.getElementById('settings-modal').classList.add('open');
  }
  function closeSettings() {
    document.getElementById('settings-modal').classList.remove('open');
  }
  
  let currentModel = 'gemini';
  
  function selectModel(model) {
    currentModel = model;
    document.getElementById('opt-gemini').classList.remove('active');
    document.getElementById('opt-gpt').classList.remove('active', 'active-gpt');
    
    if (model === 'gemini') {
      document.getElementById('opt-gemini').classList.add('active');
    } else {
      document.getElementById('opt-gpt').classList.add('active', 'active-gpt');
    }
  }

  function updateThinkingVal(val) {
    let text = 'Medium';
    if (val < 4) text = 'Low';
    if (val > 7) text = 'High';
    document.getElementById('thinking-val').innerText = text;
  }

  function updateContextVal(val) {
    const map = {1: '128k', 2: '500k', 3: '1M'};
    document.getElementById('context-val').innerText = map[val];
  }

  function saveSettings() {
    localStorage.setItem('ag_model', currentModel);
    localStorage.setItem('ag_thinking', document.getElementById('thinking-slider').value);
    
    // Trigger visual update (Mock)
    const activeModelName = currentModel === 'gemini' ? 'Gemini 3 Pro' : 'GPT-OSS 120B';
    alert(`Configuration Saved: Switched to ${activeModelName}`);
    closeSettings();
    location.reload(); // Reload to apply changes "server-side" style
  }

  // Load Saved
  const savedModel = localStorage.getItem('ag_model');
  if (savedModel) selectModel(savedModel);
</script>
