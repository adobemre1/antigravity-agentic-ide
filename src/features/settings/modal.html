
<!-- Settings Modal Injection -->
<div class="modal-overlay" id="settings-modal">
  <div class="modal-window">
    <div class="modal-header">
      <div class="modal-title">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>
        Agent Configuration
      </div>
      <div class="modal-close" onclick="closeSettings()">âœ•</div>
    </div>
    <div class="modal-body">
      
      <!-- Model Selection -->
      <div class="form-group">
        <label class="form-label">Primary Reasoning Model</label>
        <div class="model-selector">
          <div class="model-option active" id="opt-gemini" onclick="selectModel('gemini')">
            Gemini 3 Pro
            <div style="font-size: 0.7em; opacity: 0.7;">High Reasoning</div>
          </div>
          <div class="model-option" id="opt-gpt" onclick="selectModel('gpt')">
            GPT-OSS 120B
            <div style="font-size: 0.7em; opacity: 0.7;">High Speed</div>
          </div>
        </div>
      </div>

      <!-- Thinking Level -->
      <div class="form-group">
        <label class="form-label">Thinking Level (Chain of Thought)</label>
        <div class="slider-container">
          <span style="font-size: 0.8rem; opacity: 0.7;">Fast</span>
          <input type="range" min="1" max="10" value="8" id="thinking-slider" oninput="updateThinkingVal(this.value)">
          <span class="setting-value" id="thinking-val">High</span>
        </div>
      </div>

      <!-- Context Window -->
      <div class="form-group">
        <label class="form-label">Context Window Size</label>
        <div class="slider-container">
          <input type="range" min="1" max="3" value="3" id="context-slider" oninput="updateContextVal(this.value)">
          <span class="setting-value" id="context-val">1M</span>
        </div>
      </div>

    </div>
    <div class="modal-footer">
      <button class="btn-save" onclick="saveSettings()">Save Configuration</button>
    </div>
  </div>
</div>

<script>
  // Simple Settings Logic
  function openSettings() {
    document.getElementById('settings-modal').classList.add('open');
  }
  function closeSettings() {
    document.getElementById('settings-modal').classList.remove('open');
  }
  
  let currentModel = 'gemini';
  
  function selectModel(model) {
    currentModel = model;
    document.getElementById('opt-gemini').classList.remove('active');
    document.getElementById('opt-gpt').classList.remove('active', 'active-gpt');
    
    if (model === 'gemini') {
      document.getElementById('opt-gemini').classList.add('active');
    } else {
      document.getElementById('opt-gpt').classList.add('active', 'active-gpt');
    }
  }

  function updateThinkingVal(val) {
    let text = 'Medium';
    if (val < 4) text = 'Low';
    if (val > 7) text = 'High';
    document.getElementById('thinking-val').innerText = text;
  }

  function updateContextVal(val) {
    const map = {1: '128k', 2: '500k', 3: '1M'};
    document.getElementById('context-val').innerText = map[val];
  }

  function saveSettings() {
    localStorage.setItem('ag_model', currentModel);
    localStorage.setItem('ag_thinking', document.getElementById('thinking-slider').value);
    
    // Trigger visual update (Mock)
    const activeModelName = currentModel === 'gemini' ? 'Gemini 3 Pro' : 'GPT-OSS 120B';
    alert(`Configuration Saved: Switched to ${activeModelName}`);
    closeSettings();
    location.reload(); // Reload to apply changes "server-side" style
  }

  // Load Saved
  const savedModel = localStorage.getItem('ag_model');
  if (savedModel) selectModel(savedModel);
</script>
